-- Limpando tabelas na ordem correta para evitar erros de referência
DELETE FROM TB_ALOCA_PARA; DELETE FROM TB_PROJETA; DELETE FROM TB_PLANEJA; DELETE FROM TB_TRABALHA_EM; DELETE FROM TB_CONTRATAS;
DELETE FROM TB_PROJETOS; DELETE FROM TB_MATERIAIS; DELETE FROM TB_FORNECEDORES;
DELETE FROM TB_CLIENTES; DELETE FROM TB_ENGENHEIROS; DELETE FROM TB_ARQUITETOS; DELETE FROM TB_OPERARIOS;
DELETE FROM TB_ENDERECOS;
COMMIT;

-- Inserindo Endereços
INSERT INTO TB_ENDERECOS VALUES ('50000000', '100', 'Ap. 101', 'Rua Boa Vista', 'Centro', 'Recife', 'PE');
INSERT INTO TB_ENDERECOS VALUES ('50000000', '200', 'Casa', 'Rua Boa Vista', 'Centro', 'Recife', 'PE');
INSERT INTO TB_ENDERECOS VALUES ('01000000', '50', 'Sala 5', 'Av. Paulista', 'Bela Vista', 'São Paulo', 'SP');

-- Inserir Clientes
INSERT INTO TB_CLIENTES VALUES ( TP_CLIENTE('11111111111', 'Ana Silva') );
UPDATE TB_CLIENTES c SET c.email = 'ana.silva@email.com', c.telefones = TP_TELEFONES_ARRAY(TP_FONE('81911111111')) WHERE c.cpf = '11111111111';

INSERT INTO TB_CLIENTES VALUES ( TP_CLIENTE('22222222222', 'Marcos Paixão') );
UPDATE TB_CLIENTES c SET c.email = 'marcos.p@gmail.com', c.telefones = TP_TELEFONES_ARRAY(TP_FONE('11922222222')) WHERE c.cpf = '22222222222';


-- Inserir Engenheiro Supervisor
INSERT INTO TB_ENGENHEIROS VALUES (TP_ENGENHEIRO('88888888888', 'Mariana Gomes', TP_TELEFONES_ARRAY(TP_FONE('81988888888')), 9000.00, 'CREA-PE10000', 'Engenheiro Civil', NULL));

-- Engenheiro supervisionado
INSERT INTO TB_ENGENHEIROS VALUES (TP_ENGENHEIRO('99999999999', 'Roberto Lima', TP_TELEFONES_ARRAY(TP_FONE('81999999999')), 10500.00, 'CREA-PE10001', 'Engenheiro Mestre', (SELECT REF(e) FROM TB_ENGENHEIROS e WHERE e.cpf = '88888888888')));

-- Inserir Operário
INSERT INTO TB_OPERARIOS VALUES (TP_OPERARIO('33333333333', 'Carlos Souza', TP_TELEFONES_ARRAY(TP_FONE('81933333333')), 2500.00, 'Pedreiro'));

-- Inserir Arquiteto
INSERT INTO TB_ARQUITETOS VALUES (TP_ARQUITETO('44444444444', 'Fernanda Lima', TP_TELEFONES_ARRAY(TP_FONE('81944444444')), 7500.00, 'CAU-PE12345'));

-- Inserir Fornecedor
INSERT INTO TB_FORNECEDORES VALUES (TP_FORNECEDOR('12345678000199', 'Construtora XYZ', TP_TELEFONES_ARRAY(TP_FONE('8133334444'))));

-- Inserir Material
INSERT INTO TB_MATERIAIS VALUES (TP_MATERIAL('CIM-001', 'Cimento CPII-32', 1000, 25.50));
INSERT INTO TB_MATERIAIS VALUES (TP_MATERIAL('ACO-002', 'Vergalhão', 500, 15.75));

-- Inserir Projetos
INSERT INTO TB_PROJETOS VALUES (TP_PROJETO('PROJ001', (SELECT REF(e) FROM TB_ENDERECOS e WHERE e.cep = '50000000' AND e.numero = '100' AND e.complemento = 'Ap. 101'), 500000.00, TP_ETAPA_LIST(TP_ETAPA('Planejada', DATE '2024-06-01', DATE '2024-07-30'), TP_ETAPA('Em execução', DATE '2024-08-01', DATE '2024-12-31'))));
INSERT INTO TB_PROJETOS VALUES (TP_PROJETO('PROJ002', (SELECT REF(e) FROM TB_ENDERECOS e WHERE e.cep = '01000000' AND e.numero = '50' AND e.complemento = 'Sala 5'), 1200000.00, TP_ETAPA_LIST(TP_ETAPA('Planejada', DATE '2024-08-15', DATE '2025-01-31'))));


-- Inserir Relacionamentos
INSERT INTO TB_CONTRATAS VALUES (TP_CONTRATA((SELECT REF(c) FROM TB_CLIENTES c WHERE c.cpf = '11111111111'), (SELECT REF(p) FROM TB_PROJETOS p WHERE p.id_projeto = 'PROJ001'), DATE '2024-05-20', 500000.00, 'Parcelado em 10x'));
INSERT INTO TB_TRABALHA_EM VALUES (TP_TRABALHA_EM((SELECT REF(o) FROM TB_OPERARIOS o WHERE o.cpf = '33333333333'), (SELECT REF(p) FROM TB_PROJETOS p WHERE p.id_projeto = 'PROJ001')));
INSERT INTO TB_PLANEJA VALUES (TP_PLANEJA((SELECT REF(e) FROM TB_ENGENHEIROS e WHERE e.cpf = '88888888888'), (SELECT REF(p) FROM TB_PROJETOS p WHERE p.id_projeto = 'PROJ001'), 'Concluído', 'Concluído'));
INSERT INTO TB_PROJETA VALUES (TP_PROJETA((SELECT REF(a) FROM TB_ARQUITETOS a WHERE a.cpf = '44444444444'), (SELECT REF(p) FROM TB_PROJETOS p WHERE p.id_projeto = 'PROJ001')));
INSERT INTO TB_ALOCA_PARA VALUES (TP_ALOCA_PARA((SELECT REF(f) FROM TB_FORNECEDORES f WHERE f.cnpj = '12345678000199'), (SELECT REF(m) FROM TB_MATERIAIS m WHERE m.codigo = 'CIM-001'), (SELECT REF(p) FROM TB_PROJETOS p WHERE p.id_projeto = 'PROJ001'), DATE '2024-07-10'));
COMMIT;
